{"schema_version":"1.7.3","id":"GHSA-9hq9-cr36-4wpj","published":"2025-05-20T19:35:21Z","modified":"2025-05-20T20:27:17.097676Z","aliases":["CVE-2025-47939"],"summary":"TYPO3 Allows Unrestricted File Upload in File Abstraction Layer","details":"### Problem\nBy design, the file management module in TYPO3’s backend user interface has historically allowed the upload of any file type, with the exception of those that are directly executable in a web server context. This lack of restriction means it is possible to upload files that may be considered potentially harmful, such as executable binaries (e.g., `.exe` files), or files with inconsistent file extensions and MIME types (for example, a file incorrectly named with a `.png` extension but actually carrying the MIME type `application/zip`).\n\nAlthough such files are not directly executable through the web server, their presence can introduce indirect risks. For example, third-party services such as antivirus scanners or malware detection systems might flag or block access to the website for end users if suspicious files are found. This could negatively affect the availability or reputation of the site.\n\n### Solution\nUpdate to TYPO3 versions 9.5.51 ELTS, 10.4.50 ELTS, 11.5.44 ELTS, 12.4.31 LTS, 13.4.12 LTS that fix the problem described.\n\n> [!NOTE]\n> The mitigation strategies outlined below apply broadly to all file uploads handled through TYPO3's File Abstraction Layer (FAL), not just those performed via the backend interface. This means that any extension or custom integration leveraging FAL will also be subject to the new validation rules and configuration options. Developers are advised to review the implications for their code and refer to the [documentation of that change](https://docs.typo3.org/c/typo3/cms-core/main/en-us/Changelog/12.4.x/Important-106240-EnforceFile-extensionsAndMime-typeConsistencyInFileAbstractionLayer.html) for guidance.\n\n> [!IMPORTANT]\n>\n> **Strong security defaults - Manual actions required**\n> \n> These versions introduce new configuration options to better control which files are permitted for upload and to improve consistency checks.\n> \n> A new configuration option, `$GLOBALS['TYPO3_CONF_VARS']['SYS']['miscfile_ext']`, has been added. This option allows administrators to explicitly define which file extensions should be permitted that are not already part of the built-in text or media file groups - examples include archive formats such as `zip` or `xz`.\n> \n> In addition, two new feature flags have been introduced to enhance security:\n> * `security.system.enforceAllowedFileExtensions`, enforces the defined list of allowed file extensions. This flag is enabled by default in new TYPO3 installations, but remains disabled in existing installations to prevent breaking changes.\n> * `security.system.enforceFileExtensionMimeTypeConsistency`, ensures that the uploaded file’s extension matches its actual MIME type, providing further validation of file integrity. This flag is active by default.\n> \n> It is recommended to configure the allowed file extensions via `$GLOBALS['TYPO3_CONF_VARS']['SYS']['miscfile_ext']` and to enable the feature flag `security.system.enforceAllowedFileExtensions` to enforce the restriction.\n\n### Credits\nThanks to Hamed Kohi for reporting this issue, and to TYPO3 core & security team member Oliver Hader for fixing it.","affected":[{"package":{"name":"typo3/cms-core","ecosystem":"Packagist","purl":"pkg:composer/typo3/cms-core"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"9.0.0"},{"fixed":"9.5.51"}]}],"versions":["v9.0.0","v9.1.0","v9.2.0","v9.2.1","v9.3.0","v9.3.1","v9.3.2","v9.3.3","v9.4.0","v9.5.0","v9.5.1","v9.5.10","v9.5.11","v9.5.12","v9.5.13","v9.5.14","v9.5.15","v9.5.16","v9.5.17","v9.5.18","v9.5.19","v9.5.2","v9.5.20","v9.5.21","v9.5.22","v9.5.23","v9.5.24","v9.5.25","v9.5.26","v9.5.27","v9.5.28","v9.5.29","v9.5.3","v9.5.30","v9.5.31","v9.5.4","v9.5.5","v9.5.6","v9.5.7","v9.5.8","v9.5.9"],"database_specific":{"last_known_affected_version_range":"<= 9.5.50","source":"https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-9hq9-cr36-4wpj/GHSA-9hq9-cr36-4wpj.json"}},{"package":{"name":"typo3/cms-core","ecosystem":"Packagist","purl":"pkg:composer/typo3/cms-core"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"10.0.0"},{"fixed":"10.4.50"}]}],"versions":["v10.0.0","v10.1.0","v10.2.0","v10.2.1","v10.2.2","v10.3.0","v10.4.0","v10.4.1","v10.4.10","v10.4.11","v10.4.12","v10.4.13","v10.4.14","v10.4.15","v10.4.16","v10.4.17","v10.4.18","v10.4.19","v10.4.2","v10.4.20","v10.4.21","v10.4.22","v10.4.23","v10.4.24","v10.4.25","v10.4.26","v10.4.27","v10.4.28","v10.4.29","v10.4.3","v10.4.30","v10.4.31","v10.4.32","v10.4.33","v10.4.34","v10.4.36","v10.4.37","v10.4.4","v10.4.5","v10.4.6","v10.4.7","v10.4.8","v10.4.9"],"database_specific":{"last_known_affected_version_range":"<= 10.4.49","source":"https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-9hq9-cr36-4wpj/GHSA-9hq9-cr36-4wpj.json"}},{"package":{"name":"typo3/cms-core","ecosystem":"Packagist","purl":"pkg:composer/typo3/cms-core"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"11.0.0"},{"fixed":"11.5.44"}]}],"versions":["v11.0.0","v11.1.0","v11.1.1","v11.2.0","v11.3.0","v11.3.1","v11.3.2","v11.3.3","v11.4.0","v11.5.0","v11.5.1","v11.5.10","v11.5.11","v11.5.12","v11.5.13","v11.5.14","v11.5.15","v11.5.16","v11.5.17","v11.5.18","v11.5.19","v11.5.2","v11.5.20","v11.5.21","v11.5.22","v11.5.23","v11.5.24","v11.5.25","v11.5.26","v11.5.27","v11.5.28","v11.5.29","v11.5.3","v11.5.30","v11.5.31","v11.5.32","v11.5.33","v11.5.34","v11.5.35","v11.5.36","v11.5.37","v11.5.38","v11.5.39","v11.5.4","v11.5.40","v11.5.41","v11.5.5","v11.5.6","v11.5.7","v11.5.8","v11.5.9"],"database_specific":{"last_known_affected_version_range":"<= 11.5.43","source":"https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-9hq9-cr36-4wpj/GHSA-9hq9-cr36-4wpj.json"}},{"package":{"name":"typo3/cms-core","ecosystem":"Packagist","purl":"pkg:composer/typo3/cms-core"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"12.0.0"},{"fixed":"12.4.31"}]}],"versions":["v12.0.0","v12.1.0","v12.1.1","v12.1.2","v12.1.3","v12.2.0","v12.3.0","v12.4.0","v12.4.1","v12.4.10","v12.4.11","v12.4.12","v12.4.13","v12.4.14","v12.4.15","v12.4.16","v12.4.17","v12.4.18","v12.4.19","v12.4.2","v12.4.20","v12.4.21","v12.4.22","v12.4.23","v12.4.24","v12.4.25","v12.4.26","v12.4.27","v12.4.28","v12.4.29","v12.4.3","v12.4.30","v12.4.4","v12.4.5","v12.4.6","v12.4.7","v12.4.8","v12.4.9"],"database_specific":{"last_known_affected_version_range":"<= 12.4.30","source":"https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-9hq9-cr36-4wpj/GHSA-9hq9-cr36-4wpj.json"}},{"package":{"name":"typo3/cms-core","ecosystem":"Packagist","purl":"pkg:composer/typo3/cms-core"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"13.0.0"},{"fixed":"13.4.12"}]}],"versions":["v13.0.0","v13.0.1","v13.1.0","v13.1.1","v13.2.0","v13.2.1","v13.3.0","v13.3.1","v13.4.0","v13.4.1","v13.4.10","v13.4.11","v13.4.2","v13.4.3","v13.4.4","v13.4.5","v13.4.6","v13.4.7","v13.4.8","v13.4.9"],"database_specific":{"last_known_affected_version_range":"<= 13.4.11","source":"https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/05/GHSA-9hq9-cr36-4wpj/GHSA-9hq9-cr36-4wpj.json"}}],"references":[{"type":"WEB","url":"https://github.com/TYPO3/typo3/security/advisories/GHSA-9hq9-cr36-4wpj"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2025-47939"},{"type":"WEB","url":"https://github.com/TYPO3-CMS/core/commit/c265beed6e2c01817c534a226e80e593400f8255"},{"type":"PACKAGE","url":"https://github.com/TYPO3-CMS/core"},{"type":"WEB","url":"https://typo3.org/security/advisory/typo3-core-sa-2025-014"}],"database_specific":{"cwe_ids":["CWE-351","CWE-434"],"github_reviewed":true,"github_reviewed_at":"2025-05-20T19:35:21Z","nvd_published_at":"2025-05-20T14:15:50Z","severity":"MODERATE"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L"}]}