{"schema_version":"1.7.3","id":"DRUPAL-CONTRIB-2023-051","published":"2023-11-08T15:33:12Z","modified":"2025-12-10T23:31:55.254872Z","details":"The GraphQL module enables you to build GraphQL APIs which can include data fetching through Queries and data updates (create, update, delete) through mutations.\n\nThe module does not sufficiently validate incoming requests that are made from domains other than the one serving the GraphQL endpoint. In case a user visits a malicious site, that site may make requests on the users behalf which can lead to the execution of mutations, exposing a CSRF vulnerability. Whether data is returned to the malicious site depends on your sites CORS configuration.\n\nThis vulnerability is mitigated by the fact that a user with access to the API must have an active session cookie while visiting a malicious site. This vulnerability is also mitigated by restricting session cookies with the SameSite attribute (see solution below).","affected":[{"package":{"name":"drupal/graphql","ecosystem":"Packagist:https://packages.drupal.org/8","purl":"pkg:composer/drupal/graphql"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"3.4.0"}],"database_specific":{"constraint":"<3.4.0"}},{"type":"ECOSYSTEM","events":[{"introduced":"4.0.0"},{"fixed":"4.6.0"}],"database_specific":{"constraint":">=4.0.0 <4.6.0"}}],"database_specific":{"affected_versions":"<3.4.0 || >=4.0.0 <4.6.0","source":"https://github.com/DrupalSecurityTeam/drupal-advisory-database/blob/main/advisories/graphql/DRUPAL-CONTRIB-2023-051.json"}}],"references":[{"type":"WEB","url":"https://www.drupal.org/sa-contrib-2023-051"}],"credits":[{"name":"Sam Becker","contact":["https://www.drupal.org/user/1485048"]}]}